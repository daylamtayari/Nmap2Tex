\documentclass[12]{article}
\usepackage[cm]{fullpage}
\usepackage{array}
\usepackage{longtable}
\usepackage[table]{xcolor}
\usepackage{expl3}
\usepackage{xstring}
\usepackage{xintexpr}

\ExplSyntaxOn
\cs_new_eq:NN \LowerCase \text_lowercase:n
\ExplSyntaxOff

\setlength{\parindent}{0em}
\renewcommand{\arraystretch}{1.5}

\definecolor{None}{RGB}{157,195,231}
\definecolor{Low}{RGB}{255,255,103}
\definecolor{Medium}{RGB}{255,192,0}
\definecolor{High}{RGB}{255,102,0}
\definecolor{Critcal}{RGB}{254,0,0}

\renewcommand{\title}[1]{
    \begin{flushleft}
        \Large
        \textbf{#1}

        \vspace{0.4cm}
    \end{flushleft}
}

\newcommand{\introduction}[1]{
    #1
}

\newcommand{\hosttable}[1]{
    \begin{longtable}{ | l | l | l | @{}c@{} | }
        \hline
        \textbf{Host Name:} & \textbf{Public IP:} & \textbf{Operating System:} & \hspace{0.04cm} \textbf{Ports and Services:} \\
        \hline
        \endfirsthead
        \hline
        \textbf{Host Name:} & \textbf{Public IP:} & \textbf{Operating System:} & \hspace{0.04cm} \textbf{Ports and Services:} \\
        \hline
        \endhead
        \endfoot
        \endlastfoot

        #1
    \end{longtable}
}

\newcommand{\host}[4]{
    #1 & #2 & #3 &
    \begin{tabular}{ l | l }
        \textbf{Ports:}\hspace{1cm} & \textbf{Services:}\hspace{4cm} \\

        #4
    \end{tabular} \\
    \hline
}

\newcommand{\portserv}[2]{
    \hline

    #1 & #2 \\
}

\newcommand{\usertble}[1]{
    \begin{tabular}{ | @{}c@{} | }
        \hline
        \textbf{Users\:} \\
        \hline
        \begin{tabular}{ c | c | c | c | c | c }
            #1
        \end{tabular} \\
    \end{tabular}
}

\newcommand{\user}[6]{
    #1 & #2 & #3 & #4 & #5 & #6 \\

    \hline
}

\newcommand{\systemvuln}[4]{
    \begin{longtable}{ | l | c | }
        \hline
        \textbf{#1 - #2} & \cellcolor{\LowerCase{#3}}\textbf{#3} \\
        \hline
        \textbf{Vulnerabilities:} & \textbf{CVSS Rating:} \\                                                                              
        \endfirsthead                                                                                                                
        \hline                                                                                                                       
        \textbf{#1 - #2} & \cellcolor{\LowerCase{#3}}\textbf{#3} \\                                                                                            
        \hline                                                                                                                       
        \textbf{Vulnerabilities:} & \textbf{CVSS Rating:} \\                                                                              
        \endhead                                                                                                                     
        \endfoot                                                                                                                     
        \endlastfoot  
        #4
        \hline
    \end{longtable}
}

\newcommand{\evalVuln}[1]{%
    \xintifboolexpr{#1=0.0}
        {None}%
        {\xintifboolexpr{#1>0.0 && #1<4.0}
            {Low}%
            {\xintifboolexpr{#1>=4.0 && #1<7.0}
                {Medium}%
                {\xintifboolexpr{#1>=7.0 && #1<9.0}
                    {High}%
                    {Critical}}}}%
}

\newcommand{\vuln}[2]{
    \hline
    \rowcolor{\evalVuln{#2}} 
    #1 & \evalVuln{#2} - #2 \\
}

\begin{document}

\title{Change Me}

\vspace{0.9cm}

\introduction{Change Me}

\vspace{0.9cm}
